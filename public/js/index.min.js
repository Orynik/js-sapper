let tileMap=new Map;tileMap.set(1,"--one"),tileMap.set(2,"--two"),tileMap.set(3,"--three"),tileMap.set(4,"--four"),tileMap.set(5,"--five"),tileMap.set(6,"--six"),tileMap.set(7,"--seven"),tileMap.set(8,"--eight");const tileWidth=17,boardTaleCountY=16,boardTaleCountX=16,bombQty=40,tillQty=boardTaleCountX*boardTaleCountY;let board=document.getElementById("board"),currentTileId=null,isInitialClick=!0,bombs=new Set,numbers=[],boardSize=16;function renderTile(){board.style.width=`${boardTaleCountY*tileWidth}px`;for(let e=0;e<tillQty;e++)createTile(e)}function setup(){let e=bombQty,t=0,l=0;document.querySelectorAll(".tile").forEach(i=>{i.setAttribute("data-tile",`${t},${l}`),Math.random()<.2&&e&&(e--,bombs.add(`${t},${l}`),t>0&&numbers.push(`${t-1},${l}`),t<boardTaleCountX-1&&numbers.push(`${t+1},${l}`),l>0&&numbers.push(`${t},${l-1}`),l<boardTaleCountX-1&&numbers.push(`${t},${l+1}`),t>0&&l>0&&numbers.push(`${t-1},${l-1}`),t<boardTaleCountX-1&&l<boardTaleCountX-1&&numbers.push(`${t+1},${l+1}`),l>0&&t<boardTaleCountX-1&&numbers.push(`${t+1},${l-1}`),t>0&&l<boardTaleCountX-1&&numbers.push(`${t-1},${l+1}`)),++t>=16&&(t=0,l++)}),numbers.forEach(e=>{let t=e.split(","),l=document.querySelectorAll(`[data-tile="${parseInt(t[0])},${parseInt(t[1])}"]`)[0],i=parseInt(l.getAttribute("data-num"));i||(i=0),l.setAttribute("data-num",i+1)})}function clickTile(e){if(console.log(e),e.classList.contains("tile--checked")||e.classList.contains("tile--flagged"))return;let t=e.getAttribute("data-tile");if(bombs.has(t))alert("Ты проиграл");else{{let l=e.getAttribute("data-num");if(null!=l)return e.classList.add("tile--checked"),e.classList.add(`tile${tileMap.get(+l)}`),void setTimeout(()=>{},100);checkTile(t)}e.classList.add("tile--checked")}}function checkTile(e){let t=e.split(","),l=parseInt(t[0]),i=parseInt(t[1]);setTimeout(()=>{if(l>0){clickTile(document.querySelectorAll(`[data-tile="${l-1},${i}"`)[0],`${l-1},${i}`)}if(l<15){clickTile(document.querySelectorAll(`[data-tile="${l+1},${i}"`)[0],`${l+1},${i}`)}if(i>0){clickTile(document.querySelectorAll(`[data-tile="${l},${i-1}"]`)[0],`${l},${i-1}`)}if(i<15){clickTile(document.querySelectorAll(`[data-tile="${l},${i+1}"]`)[0],`${l},${i+1}`)}if(l>0&&i>0){clickTile(document.querySelectorAll(`[data-tile="${l-1},${i-1}"`)[0],`${l-1},${i-1}`)}if(l<15&&i<15){clickTile(document.querySelectorAll(`[data-tile="${l+1},${i+1}"`)[0],`${l+1},${i+1}`)}if(i>0&&l<15){clickTile(document.querySelectorAll(`[data-tile="${l+1},${i-1}"]`)[0],`${l+1},${i-1}`)}if(l>0&&i<15){clickTile(document.querySelectorAll(`[data-tile="${l-1},${i+1}"`)[0],`${l-1},${i+1}`)}},10)}function createTile(e){let t=document.createElement("div");t.classList.add("tile"),t.addEventListener("mousedown",()=>{t.classList.add("tile--focus")}),t.addEventListener("mouseout",()=>{t.classList.remove("tile--focus")}),t.addEventListener("click",function(e){isInitialClick&&(setup(e.target),isInitialClick=!1),clickTile(t)}),board.appendChild(t)}renderTile();